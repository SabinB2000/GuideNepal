{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";// ← import\nimport axiosInstance from\"../utils/axiosConfig\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const navigate=useNavigate();// ← grab navigate\n// Restore session on mount\nuseEffect(()=>{const token=localStorage.getItem(\"token\");if(!token){setLoading(false);return;}axiosInstance.get(\"/auth/profile/me\").then(res=>setUser(res.data)).catch(()=>{localStorage.removeItem(\"token\");setUser(null);}).finally(()=>setLoading(false));},[]);const login=(u,token)=>{localStorage.setItem(\"token\",token);setUser(u);};function logout(){localStorage.removeItem(\"token\");setUser(null);navigate(\"/\");// ← now navigate works\n}return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,loading,login,logout},children:children});}export function useAuth(){return useContext(AuthContext);}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useNavigate","axiosInstance","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","loading","setLoading","navigate","token","localStorage","getItem","get","then","res","data","catch","removeItem","finally","login","u","setItem","logout","Provider","value","useAuth"],"sources":["C:/Users/sabin/OneDrive/Desktop/GUIDE NEAPL/GuideNepal/client/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";             // ← import\r\nimport axiosInstance from \"../utils/axiosConfig\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser]     = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate            = useNavigate();               // ← grab navigate\r\n\r\n  // Restore session on mount\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    axiosInstance\r\n      .get(\"/auth/profile/me\")\r\n      .then((res) => setUser(res.data))\r\n      .catch(() => {\r\n        localStorage.removeItem(\"token\");\r\n        setUser(null);\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }, []);\r\n\r\n  const login = (u, token) => {\r\n    localStorage.setItem(\"token\", token);\r\n    setUser(u);\r\n  };\r\n\r\n  function logout() {\r\n    localStorage.removeItem(\"token\");\r\n    setUser(null);\r\n    navigate(\"/\");       // ← now navigate works\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, loading, login, logout }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  return useContext(AuthContext);\r\n}\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC7E,OAASC,WAAW,KAAQ,kBAAkB,CAAc;AAC5D,MAAO,CAAAC,aAAa,KAAM,sBAAsB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEjD,KAAM,CAAAC,WAAW,cAAGR,aAAa,CAAC,CAAC,CAEnC,MAAO,SAAS,CAAAS,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAOX,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAACY,OAAO,CAAEC,UAAU,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAAc,QAAQ,CAAcZ,WAAW,CAAC,CAAC,CAAgB;AAEzD;AACAD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAc,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAACF,KAAK,CAAE,CACVF,UAAU,CAAC,KAAK,CAAC,CACjB,OACF,CACAV,aAAa,CACVe,GAAG,CAAC,kBAAkB,CAAC,CACvBC,IAAI,CAAEC,GAAG,EAAKT,OAAO,CAACS,GAAG,CAACC,IAAI,CAAC,CAAC,CAChCC,KAAK,CAAC,IAAM,CACXN,YAAY,CAACO,UAAU,CAAC,OAAO,CAAC,CAChCZ,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,CAAC,CACDa,OAAO,CAAC,IAAMX,UAAU,CAAC,KAAK,CAAC,CAAC,CACrC,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAY,KAAK,CAAGA,CAACC,CAAC,CAAEX,KAAK,GAAK,CAC1BC,YAAY,CAACW,OAAO,CAAC,OAAO,CAAEZ,KAAK,CAAC,CACpCJ,OAAO,CAACe,CAAC,CAAC,CACZ,CAAC,CAED,QAAS,CAAAE,MAAMA,CAAA,CAAG,CAChBZ,YAAY,CAACO,UAAU,CAAC,OAAO,CAAC,CAChCZ,OAAO,CAAC,IAAI,CAAC,CACbG,QAAQ,CAAC,GAAG,CAAC,CAAQ;AACvB,CAEA,mBACET,IAAA,CAACC,WAAW,CAACuB,QAAQ,EAACC,KAAK,CAAE,CAAEpB,IAAI,CAAEE,OAAO,CAAEa,KAAK,CAAEG,MAAO,CAAE,CAAAnB,QAAA,CAC3DA,QAAQ,CACW,CAAC,CAE3B,CAEA,MAAO,SAAS,CAAAsB,OAAOA,CAAA,CAAG,CACxB,MAAO,CAAAhC,UAAU,CAACO,WAAW,CAAC,CAChC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}