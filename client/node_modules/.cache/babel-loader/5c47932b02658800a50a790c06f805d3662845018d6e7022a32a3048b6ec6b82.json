{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axiosInstance from\"../utils/axiosConfig\";import{LoadScript,GoogleMap,Marker,DirectionsRenderer}from\"@react-google-maps/api\";import{FaCar,FaWalking,FaBus}from\"react-icons/fa\";import{GiPathDistance,GiDuration}from\"react-icons/gi\";import\"../styles/Recommendations.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const containerStyle={width:\"100%\",height:\"400px\",borderRadius:\"12px\",overflow:\"hidden\"};export default function Recommendations(){const[recs,setRecs]=useState([]);const[userLoc,setUserLoc]=useState(null);const[selected,setSelected]=useState(null);const[directions,setDirections]=useState(null);const[travelMode,setTravelMode]=useState(\"DRIVING\");const[distance,setDistance]=useState(\"\");const[duration,setDuration]=useState(\"\");// 1) fetch recs\nuseEffect(()=>{(async()=>{const res=await axiosInstance.get(\"/places/recommended?limit=10\");setRecs(res.data);})();if(navigator.geolocation){navigator.geolocation.getCurrentPosition(pos=>setUserLoc({lat:pos.coords.latitude,lng:pos.coords.longitude}),()=>alert(\"Location denied, defaulting to Kathmandu\"));}},[]);// 2) whenever selected or mode changes, regen route\nuseEffect(()=>{if(!selected||!userLoc)return;const service=new window.google.maps.DirectionsService();service.route({origin:userLoc,destination:{lat:selected.latitude,lng:selected.longitude},travelMode:window.google.maps.TravelMode[travelMode]},(res,status)=>{if(status===\"OK\"){setDirections(res);const leg=res.routes[0].legs[0];setDistance(leg.distance.text);setDuration(leg.duration.text);}});},[selected,travelMode,userLoc]);const TravelButton=_ref=>{let{mode,icon:Icon,label}=_ref;return/*#__PURE__*/_jsxs(\"button\",{className:travelMode===mode?\"active\":\"\",onClick:()=>setTravelMode(mode),children:[/*#__PURE__*/_jsx(Icon,{}),\" \",label]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"recommendations-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Recommended for You\"}),/*#__PURE__*/_jsx(\"div\",{className:\"rec-grid\",children:recs.map(r=>/*#__PURE__*/_jsxs(\"div\",{className:\"rec-card \".concat((selected===null||selected===void 0?void 0:selected._id)===r._id?\"sel\":\"\"),onClick:()=>{setSelected(r);setDirections(null);},children:[/*#__PURE__*/_jsx(\"img\",{src:r.imageUrl,alt:r.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:r.name}),/*#__PURE__*/_jsx(\"p\",{children:r.category})]})]},r._id))}),/*#__PURE__*/_jsx(\"div\",{className:\"rec-map-container\",children:/*#__PURE__*/_jsx(LoadScript,{googleMapsApiKey:process.env.REACT_APP_GOOGLE_MAPS_API_KEY,children:/*#__PURE__*/_jsxs(GoogleMap,{mapContainerStyle:containerStyle,center:userLoc||{lat:27.7172,lng:85.324},zoom:11,children:[userLoc&&/*#__PURE__*/_jsx(Marker,{position:userLoc,label:\"You\",icon:\"https://maps.google.com/mapfiles/ms/icons/blue-dot.png\"}),recs.map(r=>/*#__PURE__*/_jsx(Marker,{position:{lat:r.latitude,lng:r.longitude},icon:(selected===null||selected===void 0?void 0:selected._id)===r._id?\"https://maps.google.com/mapfiles/ms/icons/green-dot.png\":\"https://maps.google.com/mapfiles/ms/icons/red-dot.png\",onClick:()=>setSelected(r)},r._id)),directions&&/*#__PURE__*/_jsx(DirectionsRenderer,{directions:directions,options:{suppressMarkers:true}})]})})}),selected&&/*#__PURE__*/_jsxs(\"div\",{className:\"rec-details\",children:[/*#__PURE__*/_jsx(\"h3\",{children:selected.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"travel-modes\",children:[/*#__PURE__*/_jsx(TravelButton,{mode:\"DRIVING\",icon:FaCar,label:\"Drive\"}),/*#__PURE__*/_jsx(TravelButton,{mode:\"WALKING\",icon:FaWalking,label:\"Walk\"}),/*#__PURE__*/_jsx(TravelButton,{mode:\"TRANSIT\",icon:FaBus,label:\"Transit\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(GiPathDistance,{}),\" \",distance]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(GiDuration,{}),\" \",duration]})]})]})]});}","map":{"version":3,"names":["React","useEffect","useState","axiosInstance","LoadScript","GoogleMap","Marker","DirectionsRenderer","FaCar","FaWalking","FaBus","GiPathDistance","GiDuration","jsx","_jsx","jsxs","_jsxs","containerStyle","width","height","borderRadius","overflow","Recommendations","recs","setRecs","userLoc","setUserLoc","selected","setSelected","directions","setDirections","travelMode","setTravelMode","distance","setDistance","duration","setDuration","res","get","data","navigator","geolocation","getCurrentPosition","pos","lat","coords","latitude","lng","longitude","alert","service","window","google","maps","DirectionsService","route","origin","destination","TravelMode","status","leg","routes","legs","text","TravelButton","_ref","mode","icon","Icon","label","className","onClick","children","map","r","concat","_id","src","imageUrl","alt","name","category","googleMapsApiKey","process","env","REACT_APP_GOOGLE_MAPS_API_KEY","mapContainerStyle","center","zoom","position","options","suppressMarkers"],"sources":["C:/Users/sabin/OneDrive/Desktop/GUIDE NEAPL/GuideNepal/client/src/pages/Recommendations.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axiosInstance from \"../utils/axiosConfig\";\r\nimport {\r\n  LoadScript,\r\n  GoogleMap,\r\n  Marker,\r\n  DirectionsRenderer,\r\n} from \"@react-google-maps/api\";\r\nimport {\r\n  FaCar,\r\n  FaWalking,\r\n  FaBus,\r\n} from \"react-icons/fa\";\r\nimport { GiPathDistance, GiDuration } from \"react-icons/gi\";\r\nimport \"../styles/Recommendations.css\";\r\n\r\nconst containerStyle = {\r\n  width: \"100%\",\r\n  height: \"400px\",\r\n  borderRadius: \"12px\",\r\n  overflow: \"hidden\",\r\n};\r\n\r\nexport default function Recommendations() {\r\n  const [recs, setRecs] = useState([]);\r\n  const [userLoc, setUserLoc] = useState(null);\r\n  const [selected, setSelected] = useState(null);\r\n  const [directions, setDirections] = useState(null);\r\n  const [travelMode, setTravelMode] = useState(\"DRIVING\");\r\n  const [distance, setDistance] = useState(\"\");\r\n  const [duration, setDuration] = useState(\"\");\r\n\r\n  // 1) fetch recs\r\n  useEffect(() => {\r\n    (async () => {\r\n      const res = await axiosInstance.get(\"/places/recommended?limit=10\");\r\n      setRecs(res.data);\r\n    })();\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(\r\n        pos => setUserLoc({\r\n          lat: pos.coords.latitude,\r\n          lng: pos.coords.longitude\r\n        }),\r\n        () => alert(\"Location denied, defaulting to Kathmandu\")\r\n      );\r\n    }\r\n  }, []);\r\n\r\n  // 2) whenever selected or mode changes, regen route\r\n  useEffect(() => {\r\n    if (!selected || !userLoc) return;\r\n    const service = new window.google.maps.DirectionsService();\r\n    service.route(\r\n      {\r\n        origin: userLoc,\r\n        destination: { lat: selected.latitude, lng: selected.longitude },\r\n        travelMode: window.google.maps.TravelMode[travelMode],\r\n      },\r\n      (res, status) => {\r\n        if (status === \"OK\") {\r\n          setDirections(res);\r\n          const leg = res.routes[0].legs[0];\r\n          setDistance(leg.distance.text);\r\n          setDuration(leg.duration.text);\r\n        }\r\n      }\r\n    );\r\n  }, [selected, travelMode, userLoc]);\r\n\r\n  const TravelButton = ({ mode, icon: Icon, label }) => (\r\n    <button\r\n      className={travelMode === mode ? \"active\" : \"\"}\r\n      onClick={() => setTravelMode(mode)}\r\n    >\r\n      <Icon /> {label}\r\n    </button>\r\n  );\r\n\r\n  return (\r\n    <div className=\"recommendations-page\">\r\n      <h2>Recommended for You</h2>\r\n\r\n      <div className=\"rec-grid\">\r\n        {recs.map(r => (\r\n          <div\r\n            key={r._id}\r\n            className={`rec-card ${selected?._id===r._id? \"sel\":\"\"}`}\r\n            onClick={() => {\r\n              setSelected(r);\r\n              setDirections(null);\r\n            }}\r\n          >\r\n            <img src={r.imageUrl} alt={r.name} />\r\n            <div className=\"info\">\r\n              <h3>{r.name}</h3>\r\n              <p>{r.category}</p>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"rec-map-container\">\r\n        <LoadScript googleMapsApiKey={process.env.REACT_APP_GOOGLE_MAPS_API_KEY}>\r\n          <GoogleMap\r\n            mapContainerStyle={containerStyle}\r\n            center={userLoc || { lat: 27.7172, lng: 85.324 }}\r\n            zoom={11}\r\n          >\r\n            {userLoc && (\r\n              <Marker\r\n                position={userLoc}\r\n                label=\"You\"\r\n                icon=\"https://maps.google.com/mapfiles/ms/icons/blue-dot.png\"\r\n              />\r\n            )}\r\n            {recs.map(r => (\r\n              <Marker\r\n                key={r._id}\r\n                position={{ lat: r.latitude, lng: r.longitude }}\r\n                icon={\r\n                  selected?._id === r._id\r\n                    ? \"https://maps.google.com/mapfiles/ms/icons/green-dot.png\"\r\n                    : \"https://maps.google.com/mapfiles/ms/icons/red-dot.png\"\r\n                }\r\n                onClick={() => setSelected(r)}\r\n              />\r\n            ))}\r\n            {directions && (\r\n              <DirectionsRenderer\r\n                directions={directions}\r\n                options={{ suppressMarkers: true }}\r\n              />\r\n            )}\r\n          </GoogleMap>\r\n        </LoadScript>\r\n      </div>\r\n\r\n      {selected && (\r\n        <div className=\"rec-details\">\r\n          <h3>{selected.name}</h3>\r\n          <div className=\"travel-modes\">\r\n            <TravelButton mode=\"DRIVING\" icon={FaCar}    label=\"Drive\" />\r\n            <TravelButton mode=\"WALKING\" icon={FaWalking} label=\"Walk\" />\r\n            <TravelButton mode=\"TRANSIT\" icon={FaBus}     label=\"Transit\" />\r\n          </div>\r\n          <div className=\"stats\">\r\n            <span><GiPathDistance /> {distance}</span>\r\n            <span><GiDuration /> {duration}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}